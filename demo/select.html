<head>
    <title>Select Tool Demo</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.0.0/openseadragon.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.17/paper-full.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="./demo.css">

    <script type="module">
        import { AnnotationToolbar } from '../src/js/annotationtoolbar.mjs';
        import{ AnnotationToolkit } from '../src/js/annotationtoolkit.mjs';
        // Basic viewer setup
        let viewer = OpenSeadragon({
            element: 'brush-viewer',
            prefixUrl: "https://openseadragon.github.io/openseadragon/images/",
            tileSources: {
                type: 'image',
                url: 'https://openseadragon.github.io/example-images/grand-canyon-landscape-overlooking.jpg',
                buildPyramid: false
            },
            minZoomImageRatio: 0.01,
            visibilityRatio: 0,
            crossOriginPolicy: 'Anonymous',
            ajaxWithCredentials: false
        });

        viewer.addHandler('open', () => {
            let paperScope = new paper.PaperScope(); // Create a new PaperScope
            paperScope.setup('brush-canvas'); // Set up Paper.js with the specified canvas ID

            // Create the AnnotationToolkit instance with annotationUI selecting a tool and add feature collections
            let annotationToolkit = new AnnotationToolkit(viewer);
            annotationToolkit.addAnnotationUI({tools:["select"], addButton:false, addFileButton:false});

            $.get('./demo-annotation.json').then(x => annotationToolkit.addFeatureCollections(x));
        });
        
        let exampleviewer = OpenSeadragon({
            element: 'example-viewer',
            prefixUrl: "https://openseadragon.github.io/openseadragon/images/",
            tileSources: {
                type: 'image',
                url: './tissue.jpg',
                buildPyramid: true
            },
            minZoomImageRatio: 0.01,
            visibilityRatio: 0,
            crossOriginPolicy: 'Anonymous',
            ajaxWithCredentials: false
        });

        exampleviewer.addHandler('open', () => {
            let exPaperScope = new paper.PaperScope(); // Create a new PaperScope
            exPaperScope.setup('example-canvas'); // Set up Paper.js with the specified canvas ID
        
            // Create the AnnotationToolkit instance for the example viewer
            let exAnnotationToolkit = new AnnotationToolkit(exampleviewer);
            exAnnotationToolkit.addAnnotationUI({tools:["select"], addButton:false, addFileButton:false});
        
            $.get('./tissue-annotation.json').then(x => exAnnotationToolkit.addFeatureCollections(x));
        });
    </script>
</head>
<body>
    <div class="content">
        <div class="demo">
            <h3>Select Tool Demo</h3>
            <div id="brush-viewer" class="viewer"></div>

            <div>
                <h4>How to Use the Select Tool:</h4>
                <p>
                    The Select Tool allows you to select and manipulate annotation items in the viewer. Here's a step-by-step guide on how to use it effectively:
                </p>
                <ol>
                    <li><strong>Single Item Selection:</strong> To select an individual item, simply click on it. The item will be highlighted, indicating it is selected. To deselect the item, click on it again while holding down the 'Ctrl' key (or 'Command' key on macOS).</li>
                    <li><strong>Area-Based Selection:</strong> To select multiple items within a specific area, click and drag your mouse to create a selection box. All items fully contained within the box will be selected.</li>
                    <li><strong>Clearing the Selection:</strong> To clear the selection, press the 'Escape' key. This will deselect all previously selected items.</li>
                </ol>
                <p>
                    The selected items will be visually distinguished from other items in the viewer, making it easy to identify the items of interest.
                </p>
            </div>
            <div>
                <h4>Keyboard Shortcuts:</h4>
                <ul>
                    <li><strong>Ctrl + Click:</strong> Hold down the 'Ctrl' key while clicking to add or remove items from the selection.</li>
                    <li><strong>Escape:</strong> Press the 'Escape' key to clear the selection and deselect all items.</li>
                </ul>
            </div>
            <div>
            </div>
        </div>
        <div class="guided-usage">
            <h3>Guided Usage: Example Select Tool Scenario</h3>
            <p>
                Imagine you are examining a WSI of a brain tissue with various notable annotations. Lets use the Select Tool to accomplish these tasks:
                    <li>Task 1: Select one blood vessel by simply clicking on the select tool then clicking the blood vessel on the viewer.</li>
                    <li>Task 2: Select a blood vessel and the grey matter annotation by click and drag.</li>
                    <li>Task 3: select two blood vessels without selecting the grey matter (hint use ctrl+click to select multiple items)</li>
            </p>
            <div id="example-viewer" class="viewer"></div>

        </div>
    </div>


    <!-- The canvas used for Paper.js -->
    <canvas id="example-canvas" style="display:none;"></canvas>
    <canvas id="brush-canvas" style="display:none;"></canvas>
</body>
</html>


